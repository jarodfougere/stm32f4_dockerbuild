################################################################################
## THIS MODULE CONFIGURES THE BUILD PIPELINE FOR THE TARGET SYSTEM
## 
## IN CASES WHERE THE TARGET SYSTEM IS AN EXTERNAL PROCESSOR OR AN 
## ARCHITECTURE THAT DOES NOT MATCH THAT OF THE SYSTEM PERFORMING THE 
## COMPILATION, THIS MODULE SHALL SET THE APPROPRIATE CONFIGURATION
##
## AUTHOR:  CARL MATTATAL
## LICENSE: RIMOT.IO INCORPORATED
################################################################################

if(DEFINED PROJECT_BUILD_TARGET)

    ####    !!! DEVELOPER NOTE: !!!
    ####
    ####    BUILD_TARGET_SYSTEM IS A DEFINITION PASSED IN 
    ####    BY THE CALL TO THE CMAKE TASK AS CONFIGURED BY THE USER 
    ####
    ####    YOU WILL NOT FIND MEANINGFUL DEFINITION FOR THE VARIABLE
    ####    IN ANY OF THE BUILD MODULES, ONLY REFERENCES TO ITS EXISTENCE
    ############################################################################

    TARGET_COMPILE_DEFINITIONS(${PROJECT_BUILD_TARGET} PUBLIC ${BUILD_TARGET_SYSTEM})
    if(DEFINED BUILD_TARGET_SYSTEM)
        if(${BUILD_TARGET_SYSTEM} STREQUAL SYSTEM_PROCESSOR)
            message("USER HAS CONFIGURED BUILD_TARGET_SYSTEM == SYSTEM_PROCESSOR")

        elseif(${BUILD_TARGET_SYSTEM} STREQUAL EXTERNAL_PROCESSOR)
            message("USER HAS CONFIGURED BUILD_TARGET_SYSTEM == EXTERNAL_PROCESSOR")
            include(${CMAKE_MODULE_PATH}/Compiler/IAR/IAR-FindBinUtils.cmake)
            include(${CMAKE_MODULE_PATH}/Compiler/IAR/IAR.cmake)
        else()
            message(FATAL_ERROR 
            "PLEASE SELECT EITHER >LOCAL< OR >PROCESSOR< AS BUILD_TARGET_SYSTEM")
        endif()
    endif() # END OF IF(DEFINED BUILD_TARGET_SYSTEM)
else()
    message(FATAL_ERROR "PROJECT HAS NOT DEFINED >PROJECT_BUILD_TARGET<")
endif()